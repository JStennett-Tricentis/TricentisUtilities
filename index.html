<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Tosca Cloud Navigation</title>
	<link rel="icon" type="image/jpeg" sizes="16x16" href="assets/images/Tricentis_Logo_16x16.jpeg">
	<link rel="icon" type="image/jpeg" sizes="32x32" href="assets/images/Tricentis_Logo_28x28.jpeg">
	<link rel="icon" type="image/jpeg" sizes="48x48" href="assets/images/Tricentis_Logo_48x48.jpeg">
	<link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
	<link rel="apple-touch-icon" sizes="128x128" href="assets/images/Tricentis_Logo_128x128.jpeg">
	<link rel="stylesheet" href="styles.css">
</head>

<body>
	<div class="container">
		<div class="header">
			<h1>🚀 Tosca Tools</h1>
			<p>Cloud navigation, log parsing, and productivity tools</p>
		</div>

		<div class="content">
			<div class="tabs">
				<button type="button" class="tab active" onclick="switchTab('logparser')">📊 Log Parser</button>
				<button type="button" class="tab" onclick="switchTab('navigation')">🎯 Navigation</button>
				<button type="button" class="tab" onclick="switchTab('jira')">🎫 JIRA</button>
				<button type="button" class="tab" onclick="switchTab('bookmarklet')">📌 Bookmarklet</button>
				<button type="button" class="tab" onclick="switchTab('config')">⚙️ Configure</button>
			</div>

			<!-- Log Parser Tab -->
			<div id="logparser-tab" class="tab-content active">
				<div class="section">
					<h2>📊 Tosca Log Parser</h2>
					<p style="margin-bottom: 20px; color: #6c757d;">Advanced log parsing and analysis tool for Tosca
						Cloud execution logs.</p>

					<!-- Input Section -->
					<div class="log-parser-input-section">
						<div class="log-parser-input-tabs">
							<button type="button" id="pasteBtn" class="log-parser-input-btn active">📝 Paste Logs</button>
							<button type="button" id="fileBtn" class="log-parser-input-btn">📁 Load File</button>
							<select id="debugExamplesSelect" class="log-parser-debug-examples" title="Load debug log examples for testing">
								<option value="">📄 Load Debug Example</option>
								<option value="logs-simple-example.txt">Simple Example</option>
								<option value="logs-cleaned-up.txt">Cleaned Up</option>
								<option value="logs-complete-logs-example.txt">Complete Example</option>
								<option value="logs-formating-idea.txt">Formatting Idea</option>
							</select>
							<button type="button" id="debugBtn" class="log-parser-debug-toggle">🐛 Debug</button>
						</div>

						<div id="pasteMode" class="log-parser-input-mode active">
							<textarea id="logInput" placeholder="Paste your Tosca logs here..."
								style="width: 100%; height: 120px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 12px; resize: vertical;"></textarea>
						</div>

						<div id="fileMode" class="log-parser-input-mode">
							<input type="file" id="fileInput" accept=".json,.txt,.log" class="log-parser-file-input" title="Select a log file to upload and parse">
						</div>
					</div>

					<button type="button" id="parseBtn" class="log-parser-parse-button">🔄 Parse Logs</button>

					<!-- Combined Header -->
					<div id="combinedHeader" class="log-parser-filters-section" style="display: none;">
						<div class="log-parser-filters-content">

							<div class="log-parser-view-controls">
								<button type="button" id="variablesViewBtn" class="log-parser-view-btn active">📊 Variables</button>
								<button type="button" id="cardsViewBtn" class="log-parser-view-btn">🗂️ Cards</button>
								<button type="button" id="logsViewBtn" class="log-parser-view-btn">📋 Logs</button>
								<button type="button" id="tableViewBtn" class="log-parser-view-btn">📋 Table</button>
								<button type="button" id="wordWrapBtn" class="log-parser-view-btn" style="display: none;">📄 Wrap</button>
							</div>
							<div class="log-parser-action-controls">
								<button type="button" id="copyAllBtn" class="log-parser-action-btn btn-copy">📋 Copy All</button>
								<button type="button" id="exportBtn" class="log-parser-action-btn btn-export">💾 Export JSON</button>
							</div>
							<div id="combinedCount" class="log-parser-buffer-count"></div>
							<input type="text" id="searchFilter" placeholder="Search..." class="search-input">
						</div>
					</div>

					<!-- Results Section -->
					<div class="log-parser-results-section">
						<div class="log-parser-results-container">
							<div id="resultsPlaceholder" class="log-parser-results-placeholder">
								<p style="font-size: 2em;">📊</p>
								<p>Parse logs to see extracted variables here</p>
							</div>
							<div id="resultsContent" class="log-parser-results-content"></div>
							<div id="cardsViewContent" class="log-parser-cards-view-content" style="display: none;">
								<div class="operation-cards">
									<!-- Cards will be dynamically generated here -->
								</div>
							</div>
							<div id="logViewContent" class="log-parser-log-view-content" style="display: none;"></div>
							<div id="tableViewContent" class="log-parser-table-view-content" style="display: none;">
							</div>
						</div>
					</div>

					<!-- Debug Section -->
					<div id="debugSection" class="log-parser-debug-section">
						<div id="debugContent" class="log-parser-debug-content"></div>
					</div>

					<!-- Footer -->
					<div class="log-parser-footer">
						<button type="button" id="clearBtn" class="btn-warning">🗑️ Clear Results</button>
					</div>
				</div>
			</div>

			<!-- Navigation Tab -->
			<div id="navigation-tab" class="tab-content">
				<div class="section">
					<h2>🎯 Environment Navigation</h2>

					<div class="form-row">
						<div class="form-group">
							<label for="environment">Select Environment:</label>
							<select id="environment" onchange="updateTenants()">
							</select>
						</div>

						<div class="form-group">
							<label for="tenant">Select Tenant:</label>
							<select id="tenant" onchange="updateWorkspaces()">
							</select>
						</div>
					</div>

					<div class="form-row">
						<div class="form-group">
							<label for="workspace">Select Workspace:</label>
							<select id="workspace" onchange="updatePages()">
							</select>
						</div>

						<div class="form-group">
							<label for="page">Select Page:</label>
							<select id="page" onchange="updateUrlPreview()">
							</select>
						</div>
					</div>

					<div class="form-group">
						<label for="customPath">Or Custom Path:</label>
						<input type="text" id="customPath" placeholder="/your/custom/path" />
					</div>

					<div class="url-display" id="urlPreview">
						URL Preview: Select an environment to begin
					</div>

					<div class="button-group">
						<button type="button" class="btn-primary" onclick="navigationToUrl()">🔗 Open in Current Tab</button>
						<button type="button" class="btn-secondary" onclick="navigationToUrl(true)">🆕 Open in New Tab</button>
					</div>
				</div>
			</div>

			<!-- JIRA Tab -->
			<div id="jira-tab" class="tab-content">
				<div class="section">
					<h2>🎫 JIRA Ticket Lookup</h2>

					<div class="form-group">
						<label for="jiraTicket">Ticket Number or ID:</label>
						<input type="text" id="jiraTicket" placeholder="e.g., 12345 or TPI-12345"
							onkeydown="handleJiraEnter(event)" />
						<p style="margin-top: 8px; color: #6c757d; font-size: 14px;">
							Enter just the number (e.g., 12345) to auto-prefix with "TPI-", or enter the full ticket ID
							(e.g., TPI-12345)
						</p>
					</div>

					<div class="button-group">
						<button type="button" class="btn-primary" onclick="openJiraTicket()">🔗 Open in Current Tab</button>
						<button type="button" class="btn-secondary" onclick="openJiraTicket(true)">🆕 Open in New Tab</button>
					</div>
				</div>

				<div class="section">
					<h2>📌 JIRA Bookmarklet</h2>
					<p style="margin-bottom: 15px;">Drag this link to your bookmarks bar for quick JIRA ticket lookup
						from any page:</p>
					<a href="javascript:(function(){var id=prompt('Enter the Jira ticket number:');if(id){var url=isNaN(id)?id:'TPI-'+id;window.open('https://tricentis.atlassian.net/browse/'+url,'_blank');}})();"
						class="bookmarklet-link">🎫 JIRA Lookup</a>
				</div>
			</div>

			<!-- Bookmarklet Tab -->
			<div id="bookmarklet-tab" class="tab-content">
				<div class="section bookmarklet-section">
					<h2>📌 Tosca Cloud Navigation Bookmarklet</h2>
					<p style="margin-bottom: 15px;">Drag this link to your bookmarks bar for quick Tosca Cloud
						navigation from any page:</p>
					<a href="#" id="bookmarkletLink" class="bookmarklet-link">📌 Tosca Cloud Navigation</a>
				</div>

				<div class="section bookmarklet-section">
					<h2>🎫 JIRA Lookup Bookmarklet</h2>
					<p style="margin-bottom: 15px;">Drag this link to your bookmarks bar for quick JIRA ticket lookup
						from any page:</p>
					<a href="javascript:(function(){var id=prompt('Enter the Jira ticket number:');if(id){var url=isNaN(id)?id:'TPI-'+id;window.open('https://tricentis.atlassian.net/browse/'+url,'_blank');}})();"
						class="bookmarklet-link">🎫 JIRA Lookup</a>
				</div>

				<div class="section">
					<h2>📋 How to Use</h2>
					<ol style="padding-left: 20px; line-height: 1.6;">
						<li><strong>Navigation Tab:</strong> Use the dropdowns to select your environment, tenant,
							workspace, and page, then click to navigation.</li>
						<li><strong>JIRA Tab:</strong> Enter a ticket number or full ticket ID to quickly open JIRA
							tickets in Tosca Cloud Atlassian.</li>
						<li><strong>Configure Tab:</strong> Add or modify environments, tenants, and workspaces using
							either JSON or the visual editor.</li>
						<li><strong>Bookmarklets:</strong> Drag the bookmarklets above to your bookmarks bar for quick
							access from any page.</li>
						<li><strong>Custom Paths:</strong> Enter any custom path in the text field to navigation to
							specific pages not listed in the dropdown.</li>
					</ol>
				</div>
			</div>

			<!-- Config Tab -->
			<div id="config-tab" class="tab-content">
				<div class="section">
					<h2>⚙️ Configuration Manager</h2>

					<div class="form-group">
						<label for="configFileSelect">Configuration File:</label>
						<select id="configFileSelect" onchange="loadSelectedConfigFile()">
							<option value="config.json">config.json (Default)</option>
							<option value="config.fusionx.json">config.fusionx.json</option>
							<option value="config.example.json">config.example.json</option>
						</select>
						<p style="margin-top: 8px; color: #6c757d; font-size: 14px;">
							Select which configuration file to load and use for the bookmarklet
						</p>
					</div>

					<div class="form-row">
						<div>
							<h3>📝 JSON Configuration</h3>
							<p style="margin-bottom: 15px; color: #6c757d;">Edit the complete configuration as JSON for
								bulk changes:</p>
							<textarea id="configJson" placeholder="Configuration will appear here..."></textarea>
							<div class="button-group">
								<button type="button" class="btn-info" onclick="loadConfig()">📥 Load from JSON</button>
								<button type="button" class="btn-warning" onclick="resetToDefault()">🔄 Reset to Default</button>
							</div>
							<div id="configStatus"></div>
						</div>

						<div>
							<h3>🎛️ Visual Editor</h3>
							<p style="margin-bottom: 15px; color: #6c757d;">Quick add/edit using forms:</p>

							<div class="form-group">
								<label for="newEnvName">Environment Name:</label>
								<input type="text" id="newEnvName" placeholder="e.g., Development" />
							</div>

							<div class="form-group">
								<label for="newEnvKey">Environment Key:</label>
								<input type="text" id="newEnvKey" placeholder="e.g., my-dev" />
							</div>

							<button type="button" class="btn-secondary" onclick="addEnvironment()"
								style="width: 100%; margin-bottom: 20px;">➕ Add Environment</button>

							<div class="form-group">
								<label for="tenantEnvSelect">Select Environment for Tenant:</label>
								<select id="tenantEnvSelect">
									<option value="">-- Select Environment --</option>
								</select>
							</div>

							<div class="form-group">
								<label for="newTenantName">Tenant Name:</label>
								<input type="text" id="newTenantName" placeholder="e.g., FusionX" />
							</div>

							<div class="form-group">
								<label for="newTenantKey">Tenant Key:</label>
								<input type="text" id="newTenantKey" placeholder="e.g., fusionx" />
							</div>

							<button type="button" class="btn-secondary" onclick="addTenant()"
								style="width: 100%; margin-bottom: 20px;">➕ Add Tenant</button>

							<div class="form-group">
								<label for="newUriName">Workspace Name:</label>
								<input type="text" id="newUriName" placeholder="e.g., Admin Panel" />
							</div>

							<div class="form-group">
								<label for="newUriKey">Workspace Key:</label>
								<input type="text" id="newUriKey" placeholder="e.g., admin-panel" />
							</div>

							<div class="form-group">
								<label for="newUriType">Workspace Type:</label>
								<select id="newUriType">
									<option value="portal">Portal Workspace (/_portal/space/...)</option>
									<option value="custom">Custom Path</option>
								</select>
							</div>

							<div class="form-group" id="workspaceNameGroup">
								<label for="newUriWorkspace">Portal Workspace Name:</label>
								<input type="text" id="newUriWorkspace" placeholder="e.g., MyWorkspace" />
							</div>

							<div class="form-group" id="customPathGroup" style="display: none;">
								<label for="newUriPath">Custom Path:</label>
								<input type="text" id="newUriPath" placeholder="e.g., /_admin/dashboard" />
							</div>

							<button type="button" class="btn-secondary" onclick="addSharedUri()"
								style="width: 100%; margin-bottom: 20px;">➕ Add Workspace</button>

							<div id="configEditor">
								<!-- Dynamic config editor will appear here -->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		// Global function for toggling JSON in table view
		function toggleTableJson(jsonId) {
			const content = document.getElementById(jsonId);
			const toggle = document.getElementById(jsonId + '-toggle');

			if (content && toggle) {
				const isExpanded = content.style.display !== 'none';

				if (isExpanded) {
					content.style.display = 'none';
					toggle.textContent = '▶';
					toggle.classList.remove('expanded');
				} else {
					content.style.display = 'block';
					toggle.textContent = '▼';
					toggle.classList.add('expanded');
				}
			}
		}
	</script>
	<script src="js/config.js"></script>
	<script src="js/navigation.js"></script>
	<script src="js/bookmarklet.js"></script>
	<script src="js/app.js"></script>
	<script type="module" src="log-parser-js/ToscaLogParserApp.js"></script>
</body>

</html>